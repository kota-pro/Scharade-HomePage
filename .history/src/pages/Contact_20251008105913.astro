---
import '../styles/UA+reset.css';
import Layout from '../layouts/Layout.astro';
---
<Layout>
<Fragment slot="main-slot">
    <div class = "section-title a-anchor"> 
        <h1>Contact</h1>
        <div class = "section-title-line"></div>
    </div>
</Fragment>
<Fragment slot="body-slot">
    <p class="contact-description">写団 シャレードに興味を持っていただきありがとうございます。</br></br>入会希望や見学、撮影の依頼などお問い合わせは、下記のメールフォームからご気軽にお問い合わせください。</br>後日、ご連絡させて頂きます。</p>
    <div class="contact-form">
        <form class="form" action="../src/components/mail.php" method="post">
            <table class="form-table">
                <tbody>
                    <tr>
                        <th><p>お名前</p></th>
                        <td class="require-td"><p id="require">必須</p></td>
                        <td class="input-td"><input type="text" name="name" autocomplete="name" required></td>
                    </tr>
                    <tr>
                        <th><p>フリガナ</p></th>
                        <td class="require-td"><p id="require">必須</p></td>
                        <td class="input-td"><input type="text" name="furigana" autocomplete="name" id="inputField" required></td>
                    </tr>
                    <tr>
                        <th><p>所属教育機関</p></th>
                        <td class="require-td"><p id="require">必須</p></td>
                        <td class="input-td"><input type="text" placeholder="※学生でない方は所属企業名をお書きください。" name="institution" autocomplete="organization" required></td>
                    </tr>
                    <tr>
                        <th><p>学部</p></th>
                        <td class="require-td"></td>
                        <td class="input-td"><input type="text" name="faculty"></td>
                    </tr>
                    <tr>
                        <th><p>学年</p></th>
                        <td class="require-td"></td>
                        <td class="input-td">
                            <span><input class="grade-selection" type="radio" value="1年" name="grade[]" id="grade-1"><label for="grade-1">1年</label></span>
                            <span><input class="grade-selection" type="radio" value="2年" name="grade[]" id="grade-2"><label for="grade-2">2年</label></span>
                            <span><input class="grade-selection" type="radio" value="3年" name="grade[]" id="grade-3"><label for="grade-3">3年</label></span>
                            <span><input class="grade-selection" type="radio" value="4年" name="grade[]" id="grade-4"><label for="grade-4">4年</label></span>

                            <span><input class="grade-selection" type="radio" value="院生" name="grade[]" id="grade-5"><label for="grade-5">院生</label></span>
                            <span><input class="grade-selection" type="radio" value="留学生" name="grade[]" id="grade-6"><label for="grade-6">留学生</label></span>
                            <span><input class="grade-selection" type="radio" value="その他" name="grade[]" id="grade-7"><label for="grade-7">その他</label></span>
                        </td>
                    </tr>
                    <tr>
                        <th><p>メールアドレス</p></th>
                        <td class="require-td"><p id="require">必須</p></td>
                        <td class="input-td"><input type="email" name="Email" autocomplete="email" required></td>
                    </tr>
                    <tr>
                        <th><p>お問い合わせ内容</p></th>
                        <td class="require-td"><p id="require">必須</p></td>
                        <td class="input-td">
                            <span><input class="inquiry-selection" type="radio" name="inquiry[]" required id="inquiry-1"><label for="inquiry-1">入会希望</label></span>
                            <span><input class="inquiry-selection" type="radio" name="inquiry[]" required id="inquiry-2"><label for="inquiry-2">見学・体験希望</label></span>
                            <span><input class="inquiry-selection" type="radio" name="inquiry[]" required id="inquiry-3"><label for="inquiry-3">撮影依頼</label></span>
                            <span><input class="inquiry-selection" type="radio" name="inquiry[]" required id="inquiry-4"><label for="inquiry-4">その他</label></span>
                        </td>
                    </tr>
                    <tr>
                        <th ><p>お問い合わせ詳細</p></th>
                        <td class="require-td"></td>
                        <td class="text-td"><textarea name="message" rows="8" placeholder="※上記で「その他」を選択した方はこちらにお書きください。"></textarea></td>
                    </tr>
                </tbody>
            </table>
            <div class="button-div">
                <div class = "section-title-line"></div>
                <input type="submit" class="confirm-button" value="Confirm">
                <div class = "section-title-line"></div>
            </div>
        </form>
</Fragment>
</Layout>

<!-- 判定のため、JavaScriptを追加 -->
<script>
    (() => {
        // チェックボックスのinputタグを取得
        const checkBoxElements = Array.from(document.getElementsByClassName("inquiry-selection")) as HTMLInputElement[];

        const errorMessage = "1つ以上の選択肢を選択してください。";
        checkBoxElements
            .forEach(m => {
                // エラーメッセージを、カスタムなものに変更
                m.setCustomValidity(errorMessage);

                // 各チェックボックスのチェックのオン・オフ時に、以下の処理が実行されるようにする
                m.addEventListener("change", () => {
                    // 1つ以上チェックがされているかどうかを判定
                    const isCheckedAtLeastOne = document.querySelector(".inquiry-selection:checked") !== null;

                    // 1つもチェックがされていなかったら、すべてのチェックボックスを required にする
                    // 加えて、エラーメッセージも変更する
                    checkBoxElements.forEach(n => {
                        n.required = !isCheckedAtLeastOne
                        n.setCustomValidity(isCheckedAtLeastOne ? "" : errorMessage);
                    });
                });
            });
    })();

    function toFullWidthKatakana(str) {
        return str.replace(/[\u3041-\u3096]/g, function(match) {
            // ひらがなを全角カタカナに変換
            return String.fromCharCode(match.charCodeAt(0) + 0x60);
        });
    }

    function convertInputToKatakana() {
        const inputField = document.getElementById('inputField');
        if (inputField && inputField instanceof HTMLInputElement) {
            const inputValue = inputField.value;
            const convertedValue = toFullWidthKatakana(inputValue);
            inputField.value = convertedValue;
        }
    }

    const inputField = document.getElementById('inputField');
    if (inputField) {
        inputField.addEventListener('input', convertInputToKatakana);
    }

    // window.addEventListener("beforeunload", (event) => {
    //     // 標準の確認ダイアログを表示させる
    //     event.preventDefault();
    //     event.returnValue = ''; // 空文字をセット（これで標準ダイアログが出る）
    // });
</script>

<style>
    .section-title {
        display: flex;
        flex-direction: row;
        align-items: space-between;
        justify-content: center;
        margin-bottom: 55px;
    }

    .section-title  h1{
        color: #000;
        font-family: "Didot";
        font-size: 96px;
        font-style: normal;
        font-weight: 400;
        line-height: normal;
        letter-spacing: 14.4px;
        padding-right: 78px;
    }

    .section-title-line {
        width: 100%;
        position: relative;
    }

    .section-title-line::after {
        content: '';
        display: block;
        width: 100%;
        height: 1px;
        background: #000;
        position: absolute;
        top: 50%;
        right: 0;
    }

    .contact-description {
        color: #000;
        font-family: "Zen Kurenaido";
        font-size: 20px;
        font-style: normal;
        font-weight: 400;
        line-height: normal;
        letter-spacing: 3px;
    }

    .contact-form {
        margin-top: 45px;
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }

    .form {
        width: 100%;
        padding: 0 140px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }

    .form p , .input-td label {
        color: #000;
        font-family: "Zen Kurenaido";
        font-size: 20px;
        font-style: normal;
        font-weight: 400;
        line-height: normal;
        letter-spacing: 3px;
    }

    .form-table {
        width: 100%;
        border-collapse: collapse;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .form-table tbody{
        width: 100%;
    }

    .form-table tr {
        width: 100%;
        margin: 40px 0;
        display: flex;
        align-items: center;
    }

    .form-table th {
        text-align: left;
        flex: 2;
    }

    .require-td {
        text-align: center;
        flex: 1;
    }

    .input-td {
        height: 50px;
        flex: 6;
        display: flex;
        align-items: center;
        justify-content: space-around;
    }

    .text-td {
        flex: 6;
        height: 200px;
    }

    .text-td textarea {
        width: 100%;
        height: 100%;
        border-radius: 5px;
        resize: none;
    }

    #require {
    color: #ff7979;
    font-family: "Zen Kurenaido";
    font-size: 14px;
    font-style: normal;
    font-weight: 400;
    line-height: normal;
    letter-spacing: 2.1px;
    }

    input[type="text"], input[type="email"], textarea {
    width: 100%;
    height: 100%;
    border-radius: 5px;
    border: 1px solid #909090;
    background: #FFF;
    padding: 10px 12px;
    }

    input[type="institution"]::placeholder {
    color: #909090;
    font-family: "Zen Kurenaido";
    font-size: 14px;
    font-style: normal;
    font-weight: 400;
    line-height: normal;
    letter-spacing: 2.1px;
    }

    .input-td span {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    gap: 5px;
    }

    .button-div {
    width: 100%;
    height: 100%;
    margin-top: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    }

    .confirm-button {
    display: inline-block;
    padding: 14px 32px 16px;
    background-color: #ffffff;
    color: #000000;
    text-decoration: none;
    font-family: "Zen Old Mincho";
    font-size: 20px;
    letter-spacing: 3px;
    border: #000000 1px solid;
    cursor: pointer;
    margin: 0 78px;
    }

    .confirm-button:hover {
    background-color: #707070; /* ホバー時の背景色 */
    color: #ffffff; /* ホバー時の文字色 */
    transition: 0.3s ease-in-out; /* ホバー時の変化をスムーズに */
    }
</style>